import{i as e}from"./vendor.5d6055c9.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const o of e)if("childList"===o.type)for(const e of o.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const t=7,o=6;let n=[];function r(){n=i()}const l=()=>n,i=()=>Array(o).fill(0).map((()=>Array(t).fill(0)));function c(e=1,r=n){var l,i;const c=[];for(let n=0;n<t;n++){const t=u(r);for(let r=0;r<o;r++)if(0!==(null==(l=t[r+1])?void 0:l[n])&&0===(null==(i=t[r])?void 0:i[n])){t[r][n]=e;const o={column:n,player:e,seq:a([t,e,r,n],4)};o.seq.length>0&&c.push(o)}}return c}function s(e,t=1,r=4){var l,i;n=u(n);for(let c=0;c<o;c++)if(0!==(null==(l=n[c+1])?void 0:l[+e])&&0===(null==(i=n[c])?void 0:i[+e])){n[c][+e]=t;const o=[...a([n,t,c,+e],r),[c,+e]];return{disc:[c,+e],seq:o.length>r-1?o:[],newGrid:n}}}function a(e,t){const o=[];return[{v:1,h:0},{v:1,h:1},{v:0,h:1},{v:1,h:-1}].forEach((n=>{const r=[...d(e,n.v,n.h),...d(e,-n.v,-n.h)];r.length>t-2&&o.push(...r)})),o}const u=e=>e.map((e=>e.slice()));function d([e,t,o,n],r,l){var i;let c=[];for(let s=1;(null==(i=e[o+r*s])?void 0:i[n+l*s])===t;s++)c.push([o+r*s,n+l*s]);return c}function f(e){let t=0;for(let o=n.length-1;o>=0;o--){if(0===n[o][e])return t;t++}return n.length}function p(){let e=!0;return n[0].forEach((t=>0===t?e=!1:void 0)),e}const h=()=>(()=>{let e=-1;if(p())return;const n=c(2);if(n.length>0&&(e=n[0].column),e>=0){const t=s(e,2);if(t)return t;throw new Error("drop failed")}const r=c(1);if(r.length>0&&(e=r[0].column),e>=0){const t=s(e,2);if(t)return t;throw new Error("drop failed")}e=-1;const i=e=>f(e)===o,a=l(),u=(d=a.length-3,!a[d].reduce(((e,t,o)=>e+a[d][o]),0));var d;const h=Array(t).fill(0);for(;e<0;){e=u?Math.floor(5*Math.random())+1:Math.floor(7*Math.random()),h[e]=1;const o=h.reduce(((e,t,o)=>e+t),0);if(i(e)&&o===t)break;if(i(e)){e=-1;continue}const n=s(e,2);if(n){if(r.length>0){e=-1;continue}return n}throw new Error(`drop failed on column ${e}, ${f(a)}, ${a.length}`)}throw new Error("drop failed")})();let m;const y=document.querySelector("#grid");let g=!1,v="";function w(e,t){let o;if(o=e?s(t):g?s(t,2):h(),console.log("isPlayer",e,"discDrop",o),o){if(e&&(g?function(e){if(!m)throw new Error("not connected to server");if("number"!=typeof e)throw new Error(`invalid column: ${e}`);m.emit("drop",e),console.log(`emit ${e}`)}(t):setTimeout((()=>{w(!e,t)}),400)),r=o.newGrid,n=r,E([o.disc],e?1:2),o.seq.length>0&&E(o.seq,e?-1:-2),o.seq.length>=4&&(v="gameover"),"gameover"===v)return b(e?"player":"opponent");if(p())return b("none")}var r}function q(){l().forEach(((e,t)=>{e.forEach(((e,o)=>{const n=$("slot-template").querySelector(".slot");n.dataset.x=o,n.dataset.y=t,y.appendChild(n)}))}))}function E(e,t){e.forEach((e=>{y.querySelector(`.slot[data-y="${e[0]}"][data-x="${e[1]}"]`).dataset.value=t}))}function S(){document.querySelector(".title").remove(),v="player"}function b(e){const t=$("game-over-template");var o;t.querySelector("#game-over-result").textContent="player"==(o=e)?"Player Wins! ðŸŽ‰":"opponent"==o?"Opponent Wins ðŸ˜‚":"Tie Game ðŸ˜¦",document.body.appendChild(t)}function $(e){return document.getElementById(e).content.cloneNode(!0)}networking&&io("http://localhost:5000"),function(){const e=$("title-template").querySelector(".title");v="title",document.body.appendChild(e)}(),r(),y.style.setProperty("--width",t),y.style.setProperty("--height",o),q(),document.querySelector(".title").onclick=t=>"dumbot"===t.target.id?(g&&(m=void 0,g=!1),S()):"onlineMultiplayer"===t.target.id?(g||(function(t="http://localhost:5000"){console.log(t),m=e(t)}(),g=!0,function(e){if(!m)throw new Error("not connected to server");if("function"!=typeof e)throw new Error("callback is not a function");m.on("opponent-found",e)}((()=>{}))),S()):void 0,document.querySelector("#grid").onclick=e=>{"gameover"===v&&(document.querySelector(".game-over").remove(),v="player",r(),y.innerHTML="",y.style.setProperty("--width",t),y.style.setProperty("--height",o),q()),e.target.classList.contains("slot")&&"player"==v&&(g?alert("waiting for an opponent..."):(v="opponent",w(!0,+e.target.dataset.x),g||setTimeout((()=>{"opponent"===v&&(v="player")}),800)))},g&&listenForOpponentDrop((e=>{console.log(`on ${e}`),v="player",w(!1,e)}));
